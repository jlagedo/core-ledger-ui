/* ============================================================
   ðŸŒŠ DEEP OCEAN THEME â€” v2 Ultra-Optimized
============================================================ */

@use "sass:color";
@use "sass:map";
@use "sass:list";

// ============================================================
// 1. Bootstrap Configuration
// ============================================================

@use "bootstrap/scss/bootstrap" with ($enable-dark-mode: true,
  $primary: #0077B6, $secondary: #003566, $dark: #001D3D, $light: #F8FBFA,
  $success: #00F5D4, $info: #00BBF9, $warning: #FFB703, $danger: #E63946,
  $font-size-base: 0.85rem,
  $body-bg: #F8FBFA, $body-color: #212529,
  $body-bg-dark: #000814, $body-color-dark: #E9ECEF,
  $body-secondary-bg-dark: #001D3D, $body-tertiary-bg-dark: #003566);

@import "bootstrap-icons/font/bootstrap-icons.css";

// ============================================================
// 2. Design Tokens
// ============================================================

$ocean: (
  surface: #00A8E8,
  twilight: #0077B6,
  midnight: #003566,
  abyss: #001D3D,
  trench: #000814
);
$sunlit: (
  sky: #E8F4F8,
  foam: #F8FBFA,
  shallow: #D4EBF2,
  sand: #FDF6E3,
  lagoon: #B8E0EC,
  coral: #FF8A80,
  anemone: #EA80FC,
  starfish: #FFB74D,
  seagrass: #81C784,
  pearl: #FFF,
  text-primary: #1A2B3C,
  text-secondary: #4A5568,
  text-muted: #718096,
  border: #CBD5E0,
  border-light: #E2E8F0
);
$bio: (
  anglerfish: #00F5D4,
  jellyfish: #9B5DE5,
  anemone: #F15BB5,
  phosphor: #FEE440
);
$neutral: (
  foam: #F8FBFA,
  mist: #E9ECEF,
  silt: #ADB5BD,
  kelp: #6C757D,
  current: #495057,
  pressure: #212529
);

// Shorthand accessors
@function o($k) {
  @return map.get($ocean, $k);
}

@function s($k) {
  @return map.get($sunlit, $k);
}

@function b($k) {
  @return map.get($bio, $k);
}

@function n($k) {
  @return map.get($neutral, $k);
}

// Shared values
$tr: 0.2s ease-in-out;
$tr-wave: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
$blur-sm: 10px;
$blur-md: 12px;
$shadow-l: (
  sm: 0 1px 4px rgba(26, 43, 60, 0.12),
  md: 0 4px 12px rgba(26, 43, 60, 0.14),
  lg: 0 10px 40px rgba(26, 43, 60, 0.16)
);
$shadow-d: (
  sm: 0 2px 8px rgba(0, 0, 0, 0.3),
  md: 0 4px 20px rgba(0, 0, 0, 0.4),
  lg: 0 10px 40px rgba(0, 0, 0, 0.5)
);

// ============================================================
// 3. Theme Token Maps (Single Source for Light/Dark)
// ============================================================

$theme-tokens: (
  light: (body-bg: s(foam), body-color: s(text-primary), emphasis: o(midnight),
    link: o(twilight), link-hover: o(surface), link-visited: color.scale(o(twilight), $lightness: -15%, $saturation: -20%), border: s(border), border-trans: rgba(26, 43, 60, 0.12),
    shadow-sm: map.get($shadow-l, sm), shadow-md: map.get($shadow-l, md), shadow-lg: map.get($shadow-l, lg),
    focus-ring: rgba(o(twilight), 0.4), focus-outline: o(midnight), focus-ring-offset: 2px,
    disabled-bg: rgba(n(silt), 0.15), disabled-color: n(kelp), disabled-border: s(border-light), disabled-opacity: 0.65,
    input-error-bg: rgba(s(coral), 0.08),
    valid: color.adjust(s(seagrass), $lightness: -15%), valid-border: s(seagrass),
    invalid: color.adjust(s(coral), $lightness: -20%), invalid-border: s(coral),
    card-bg: s(pearl), card-border: s(border), card-header: rgba(s(lagoon), 0.12),
    glass-bg: rgba(255, 255, 255, 0.85), glass-border: rgba(203, 213, 224, 0.6), glass-shadow: 0 4px 30px rgba(26, 43, 60, 0.12),
    input-bg: s(pearl), input-border: s(border), input-focus: o(surface), input-focus-shadow: 0 0 0 0.25rem rgba(o(surface), 0.2), input-placeholder: s(text-muted),
    table-bg: s(pearl), table-header-bg: s(sky), table-header-color: s(text-primary), table-striped: rgba(s(lagoon), 0.08),
    table-hover: rgba(o(surface), 0.1), table-active-bg: rgba(o(twilight), 0.15), table-active-color: s(text-primary),
    table-active-border: o(twilight), table-border: s(border-light), table-cell: s(text-primary),
    table-action: s(text-secondary), table-action-hover: o(twilight),
    btn-primary-hover: color.scale(o(twilight), $lightness: -10%), btn-sec-bg: s(text-secondary), btn-sec-color: #fff, btn-sec-hover: color.scale(s(text-secondary), $lightness: 15%),
    nav-active: o(surface), nav-underline: linear-gradient(90deg, o(surface), o(twilight)),
    scrollbar-track: rgba(n(silt), 0.1), scrollbar-thumb: linear-gradient(180deg, o(twilight), o(midnight)),
    selection: rgba(o(twilight), 0.3), dropdown-bg: rgba(248, 251, 250, 0.95), dropdown-border: rgba(26, 43, 60, 0.12),
    sidenav-bg: o(abyss), sidenav-color: s(sand), sidenav-gradient: radial-gradient(circle 500px at 50% 300px, rgba(o(twilight), 0.15), transparent),
    sidenav-hover: rgba(s(sand), 0.05), sidenav-active-bg: rgba(o(surface), 0.15), sidenav-active-border: o(surface), sidenav-divider: rgba(o(surface), 0.1)),
  dark: (body-bg: o(trench), body-color: n(mist), emphasis: #FFF,
    link: o(surface), link-hover: color.scale(o(surface), $lightness: 20%), link-visited: color.scale(o(surface), $lightness: -10%, $saturation: -15%), border: rgba(o(surface), 0.15), border-trans: rgba(255, 255, 255, 0.1),
    shadow-sm: map.get($shadow-d, sm), shadow-md: map.get($shadow-d, md), shadow-lg: map.get($shadow-d, lg),
    focus-ring: rgba(b(anglerfish), 0.5), focus-outline: b(anglerfish), focus-ring-offset: 2px,
    disabled-bg: rgba(n(current), 0.3), disabled-color: n(silt), disabled-border: rgba(n(silt), 0.2), disabled-opacity: 0.5,
    input-error-bg: rgba(#ff6b6b, 0.1),
    valid: color.scale(b(anglerfish), $lightness: -15%), valid-border: b(anglerfish),
    invalid: #ff6b6b, invalid-border: #ff6b6b,
    card-bg: rgba(o(abyss), 0.6), card-border: rgba(o(surface), 0.1), card-header: rgba(o(surface), 0.05),
    glass-bg: rgba(255, 255, 255, 0.05), glass-border: rgba(b(anglerfish), 0.1), glass-shadow: 0 4px 30px rgba(0, 8, 20, 0.25),
    input-bg: rgba(o(abyss), 0.4), input-border: rgba(o(surface), 0.2), input-focus: b(anglerfish), input-focus-shadow: 0 0 0 0.25rem rgba(b(anglerfish), 0.15), input-placeholder: rgba(n(mist), 0.5),
    table-bg: rgba(o(abyss), 0.85), table-header-bg: rgba(o(midnight), 0.6), table-header-color: n(mist), table-striped: rgba(o(midnight), 0.25),
    table-hover: rgba(o(surface), 0.08), table-active-bg: rgba(o(twilight), 0.45), table-active-color: #fff,
    table-active-border: o(surface), table-border: rgba(o(surface), 0.1), table-cell: n(mist),
    table-action: rgba(n(mist), 0.7), table-action-hover: o(surface),
    btn-primary-hover: color.scale(o(twilight), $lightness: 15%), btn-sec-bg: n(current), btn-sec-color: #fff, btn-sec-hover: n(kelp),
    nav-active: color.scale(b(anglerfish), $lightness: -15%), nav-underline: linear-gradient(90deg, o(surface), b(anglerfish)),
    scrollbar-track: rgba(o(abyss), 0.5), scrollbar-thumb: linear-gradient(180deg, o(midnight), o(abyss)),
    selection: rgba(b(anglerfish), 0.3), dropdown-bg: rgba(o(abyss), 0.95), dropdown-border: rgba(o(surface), 0.1),
    sidenav-bg: o(trench), sidenav-color: n(mist), sidenav-gradient: radial-gradient(circle 500px at 50% 300px, rgba(b(anglerfish), 0.12), transparent),
    sidenav-hover: rgba(n(mist), 0.05), sidenav-active-bg: rgba(b(anglerfish), 0.15), sidenav-active-border: b(anglerfish), sidenav-divider: rgba(b(anglerfish), 0.1))
);

// Alert/Badge configs combined
$alerts: (
  success: (l-bg: rgba(#0A8754, 0.1), l-border: rgba(#0A8754, 0.2), l-color: #065F3E, l-accent: #0A8754,
    d-bg: rgba(b(anglerfish), 0.1), d-border: rgba(b(anglerfish), 0.3), d-color: color.scale(b(anglerfish), $lightness: -15%), d-accent: b(anglerfish), d-shadow: 0 0 10px rgba(b(anglerfish), 0.3)),
  info: (l-bg: rgba(o(surface), 0.1), l-border: rgba(o(surface), 0.2), l-color: o(midnight), l-accent: o(surface),
    d-bg: rgba(o(surface), 0.1), d-border: rgba(o(surface), 0.3), d-color: o(surface), d-accent: o(surface)),
  warning: (l-bg: rgba(s(starfish), 0.12), l-border: rgba(s(starfish), 0.25), l-color: color.adjust(s(starfish), $lightness: -35%), l-accent: s(starfish),
    d-bg: rgba(b(phosphor), 0.1), d-border: rgba(b(phosphor), 0.3), d-color: color.scale(b(phosphor), $lightness: -10%), d-accent: b(phosphor), d-shadow: 0 0 10px rgba(b(phosphor), 0.3)),
  danger: (l-bg: rgba(s(coral), 0.1), l-border: rgba(s(coral), 0.2), l-color: color.adjust(s(coral), $lightness: -30%), l-accent: s(coral),
    d-bg: rgba(#E63946, 0.1), d-border: rgba(#E63946, 0.3), d-color: #ff6b6b, d-accent: #E63946),
  primary: (l-bg: rgba(o(twilight), 0.08), l-border: rgba(o(twilight), 0.15), l-color: o(midnight), l-accent: o(twilight),
    d-bg: rgba(o(twilight), 0.15), d-border: rgba(o(twilight), 0.3), d-color: o(surface), d-accent: o(twilight)),
  secondary:(l-bg: rgba(s(text-secondary), 0.08), l-border: rgba(s(text-secondary), 0.15), l-color: s(text-primary), l-accent: s(text-secondary),
    d-bg: rgba(n(kelp), 0.15), d-border: rgba(n(kelp), 0.3), d-color: n(mist), d-accent: n(kelp))
);

$badges: (
  success: (l: #0A8754 white, d: b(anglerfish) o(trench)),
  info: (l: o(twilight) white, d: o(surface) o(trench)),
  warning: (l: #E09600 o(trench), d: b(phosphor) o(trench)),
  danger: (l: #C92A2A white, d: #ff6b6b o(trench))
);

// ============================================================
// 4. Mixin: Generate Theme CSS Vars
// ============================================================

@mixin theme-vars($mode) {
  $t: map.get($theme-tokens, $mode);
  $prefix: if($mode ==light, l, d);

  --bs-body-bg: #{map.get($t, body-bg)};
  --bs-body-color: #{map.get($t, body-color)};
  --bs-emphasis-color: #{map.get($t, emphasis)};
  --bs-link-color: #{map.get($t, link)};
  --bs-link-hover-color: #{map.get($t, link-hover)};
  --link-visited-color: #{map.get($t, link-visited)};
  --bs-border-color: #{map.get($t, border)};
  --bs-border-color-translucent: #{map.get($t, border-trans)};
  --bs-box-shadow-sm: #{map.get($t, shadow-sm)};
  --bs-box-shadow: #{map.get($t, shadow-md)};
  --bs-box-shadow-lg: #{map.get($t, shadow-lg)};
  --bs-focus-ring-color: #{map.get($t, focus-ring)};
  --btn-focus-outline: #{map.get($t, focus-outline)};
  --bs-form-valid-color: #{map.get($t, valid)};
  --bs-form-valid-border-color: #{map.get($t, valid-border)};
  --bs-form-invalid-color: #{map.get($t, invalid)};
  --bs-form-invalid-border-color: #{map.get($t, invalid-border)};

  // Components
  --card-bg: #{map.get($t, card-bg)};
  --card-border-color: #{map.get($t, card-border)};
  --card-header-bg: #{map.get($t, card-header)};
  --card-shadow: #{map.get($t, shadow-sm)};
  --card-hover-shadow: #{map.get($t, shadow-lg)};
  --glass-bg: #{map.get($t, glass-bg)};
  --glass-border: #{map.get($t, glass-border)};
  --glass-shadow: #{map.get($t, glass-shadow)};
  --input-bg: #{map.get($t, input-bg)};
  --input-border: #{map.get($t, input-border)};
  --input-focus-border: #{map.get($t, input-focus)};
  --input-focus-shadow: #{map.get($t, input-focus-shadow)};
  --input-placeholder-color: #{map.get($t, input-placeholder)};
  --input-error-bg: #{map.get($t, input-error-bg)};
  --disabled-bg: #{map.get($t, disabled-bg)};
  --disabled-color: #{map.get($t, disabled-color)};
  --disabled-border: #{map.get($t, disabled-border)};
  --disabled-opacity: #{map.get($t, disabled-opacity)};
  --focus-ring-offset: #{map.get($t, focus-ring-offset)};
  --table-bg: #{map.get($t, table-bg)};
  --table-header-bg: #{map.get($t, table-header-bg)};
  --table-header-color: #{map.get($t, table-header-color)};
  --table-striped-bg: #{map.get($t, table-striped)};
  --table-hover-bg: #{map.get($t, table-hover)};
  --table-active-bg: #{map.get($t, table-active-bg)};
  --table-active-color: #{map.get($t, table-active-color)};
  --table-active-border: #{map.get($t, table-active-border)};
  --table-border-color: #{map.get($t, table-border)};
  --table-cell-color: #{map.get($t, table-cell)};
  --table-action-color: #{map.get($t, table-action)};
  --table-action-hover-color: #{map.get($t, table-action-hover)};
  --btn-primary-hover-bg: #{map.get($t, btn-primary-hover)};
  --btn-primary-hover-border: #{map.get($t, btn-primary-hover)};
  --btn-secondary-bg: #{map.get($t, btn-sec-bg)};
  --btn-secondary-border: #{map.get($t, btn-sec-bg)};
  --btn-secondary-color: #{map.get($t, btn-sec-color)};
  --btn-secondary-hover-bg: #{map.get($t, btn-sec-hover)};
  --nav-link-active-color: #{map.get($t, nav-active)};
  --nav-link-underline: #{map.get($t, nav-underline)};
  --scrollbar-track: #{map.get($t, scrollbar-track)};
  --scrollbar-thumb: #{map.get($t, scrollbar-thumb)};
  --selection-bg: #{map.get($t, selection)};
  --dropdown-bg: #{map.get($t, dropdown-bg)};
  --dropdown-border: #{map.get($t, dropdown-border)};
  --sidenav-bg: #{map.get($t, sidenav-bg)};
  --sidenav-color: #{map.get($t, sidenav-color)};
  --sidenav-gradient: #{map.get($t, sidenav-gradient)};
  --sidenav-link-hover-bg: #{map.get($t, sidenav-hover)};
  --sidenav-active-bg: #{map.get($t, sidenav-active-bg)};
  --sidenav-active-border: #{map.get($t, sidenav-active-border)};
  --sidenav-divider: #{map.get($t, sidenav-divider)};
  --sidenav-border-color: #{map.get($t, border)};

  // Alerts
  @each $type, $cfg in $alerts {
    --alert-#{$type}-bg: #{map.get($cfg, #{$prefix}-bg)
  }

  ;
  --alert-#{$type}-border: #{map.get($cfg, #{$prefix}-border)
}

;
--alert-#{$type}-color: #{map.get($cfg, #{$prefix}-color)
}

;
--alert-#{$type}-accent: #{map.get($cfg, #{$prefix}-accent)
}

;

@if map.has-key($cfg, #{$prefix}-shadow) {
  --alert-#{$type}-text-shadow: #{map.get($cfg, #{$prefix}-shadow)
}

;
}
}

// Badges
@each $type, $cfg in $badges {
  $vals: map.get($cfg, $prefix);
  --badge-#{$type}-bg: #{list.nth($vals, 1)};
  --badge-#{$type}-color: #{list.nth($vals, 2)};
}
}

// ============================================================
// 5. Keyframes (Consolidated)
// ============================================================

@keyframes wave-shift {

  0%,
  100% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }
}

@keyframes depth-drift {

  0%,
  100% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-2px);
  }
}

@keyframes jellyfish-float {

  0%,
  100% {
    transform: translateY(0) scale(1);
    opacity: 0.8;
  }

  50% {
    transform: translateY(-4px) scale(1.02);
    opacity: 1;
  }
}

@media (prefers-reduced-motion: no-preference) {
  @keyframes bio-pulse {

    0%,
    100% {
      box-shadow: 0 0 0 0 rgba(b(anglerfish), 0.4);
    }

    50% {
      box-shadow: 0 0 20px 10px transparent;
    }
  }
}

// ============================================================
// 6. Theme Blocks
// ============================================================

body {
  position: relative;
  min-height: 100vh;
  background: var(--theme-body-gradient, var(--bs-body-bg));
  background-attachment: fixed;
  background-size: 100% 100vh;
  color: var(--bs-body-color);
}

:root,
[data-bs-theme="light"] {
  color-scheme: light;

  /* Ocean gradient with reef patterns at bottom 30% */
  --theme-body-gradient: radial-gradient(ellipse 120% 60% at 30% -10%, #{rgba(s(starfish),0.12)}, transparent 50%),
  radial-gradient(ellipse 100% 50% at 70% -5%, #{rgba(s(coral),0.08)}, transparent 45%),
  radial-gradient(ellipse 40% 80% at 0% 70%, #{rgba(s(seagrass),0.08)}, transparent 50%),
  radial-gradient(ellipse 40% 80% at 100% 60%, #{rgba(o(surface),0.12)}, transparent 50%),
  radial-gradient(ellipse 20% 25% at 5% 85%, #{rgba(s(coral), 0.22)}, transparent 70%),
  radial-gradient(ellipse 15% 22% at 12% 78%, #{rgba(s(coral), 0.18)}, transparent 60%),
  radial-gradient(ellipse 22% 18% at 20% 90%, #{rgba(o(surface), 0.15)}, transparent 65%),
  radial-gradient(ellipse 12% 30% at 8% 72%, #{rgba(s(seagrass), 0.20)}, transparent 70%),
  radial-gradient(ellipse 35% 15% at 30% 82%, #{rgba(s(lagoon), 0.25)}, transparent 80%),
  radial-gradient(ellipse 28% 18% at 38% 90%, #{rgba(o(twilight), 0.15)}, transparent 70%),
  radial-gradient(ellipse 18% 25% at 45% 76%, #{rgba(s(coral), 0.18)}, transparent 65%),
  radial-gradient(circle 60px at 50% 85%, #{rgba(s(starfish), 0.15)}, transparent 70%),
  radial-gradient(circle 45px at 58% 78%, #{rgba(o(surface), 0.18)}, transparent 60%),
  radial-gradient(circle 70px at 65% 88%, #{rgba(s(lagoon), 0.20)}, transparent 70%),
  radial-gradient(ellipse 10% 35% at 70% 74%, #{rgba(s(seagrass), 0.16)}, transparent 70%),
  radial-gradient(ellipse 8% 30% at 75% 82%, #{rgba(s(seagrass), 0.12)}, transparent 65%),
  radial-gradient(ellipse 12% 25% at 68% 86%, #{rgba(o(twilight), 0.12)}, transparent 60%),
  radial-gradient(circle 50px at 82% 82%, #{rgba(s(coral), 0.18)}, transparent 65%),
  radial-gradient(circle 35px at 88% 74%, #{rgba(s(starfish), 0.15)}, transparent 60%),
  radial-gradient(circle 55px at 92% 88%, #{rgba(o(surface), 0.15)}, transparent 70%),
  radial-gradient(ellipse 25% 15% at 95% 78%, #{rgba(s(lagoon), 0.20)}, transparent 75%),
  radial-gradient(ellipse 18% 22% at 98% 85%, #{rgba(s(coral), 0.15)}, transparent 65%),
  radial-gradient(ellipse 15% 28% at 100% 72%, #{rgba(s(seagrass), 0.18)}, transparent 70%),
  radial-gradient(ellipse 100% 20% at 50% 92%, #{rgba(s(sand), 0.35)}, transparent 80%),
  radial-gradient(ellipse 80% 15% at 25% 88%, #{rgba(s(sand), 0.25)}, transparent 70%),
  radial-gradient(ellipse 70% 12% at 75% 95%, #{rgba(s(sand), 0.20)}, transparent 60%),
  linear-gradient(180deg, #{color.scale(s(sky), $lightness: -8%)} 0%, #{color.scale(s(lagoon), $lightness: -5%)} 30%, #{color.scale(s(shallow), $lightness: -6%)} 65%, #{s(shallow)} 100%);

  @each $k, $v in $ocean {
    --ocean-#{$k}: #{$v};
  }

  @each $k, $v in $bio {
    --bio-#{$k}: #{$v};
  }

  --sunlit-lagoon: #{s(lagoon)};
  --sunlit-shallow: #{s(shallow)};
  --sunlit-sand: #{s(sand)};
  --sunlit-coral: #{s(coral)};
  --sunlit-seagrass: #{s(seagrass)};
  --sunlit-starfish: #{s(starfish)};

  @include theme-vars(light);
}

[data-bs-theme="dark"] {
  color-scheme: dark;

  /* Deep sea gradient with bioluminescent jellyfish patterns at bottom 30% */
  --theme-body-gradient: radial-gradient(ellipse 100% 30% at 50% -15%, #{rgba(o(twilight),0.15)}, transparent 50%),
  radial-gradient(ellipse 25% 20% at 15% 25%, #{rgba(b(jellyfish),0.08)}, transparent 40%),
  radial-gradient(ellipse 20% 15% at 85% 35%, #{rgba(b(jellyfish),0.05)}, transparent 35%),
  radial-gradient(circle 150px at 75% 50%, #{rgba(b(anglerfish),0.06)}, transparent 50%),
  /* Bioluminescent jellyfish - bell shapes with trailing tentacles */
  radial-gradient(ellipse 8% 12% at 8% 78%, #{rgba(b(jellyfish), 0.25)}, transparent 60%),
  radial-gradient(ellipse 3% 18% at 8% 88%, #{rgba(b(jellyfish), 0.15)}, transparent 70%),
  radial-gradient(ellipse 2% 15% at 6% 90%, #{rgba(b(jellyfish), 0.10)}, transparent 65%),
  radial-gradient(ellipse 2% 12% at 10% 92%, #{rgba(b(jellyfish), 0.08)}, transparent 60%),
  radial-gradient(ellipse 12% 15% at 22% 82%, #{rgba(b(anglerfish), 0.30)}, transparent 55%),
  radial-gradient(ellipse 4% 20% at 22% 92%, #{rgba(b(anglerfish), 0.18)}, transparent 70%),
  radial-gradient(ellipse 3% 16% at 19% 95%, #{rgba(b(anglerfish), 0.12)}, transparent 65%),
  radial-gradient(ellipse 3% 14% at 25% 96%, #{rgba(b(anglerfish), 0.10)}, transparent 60%),
  radial-gradient(ellipse 10% 14% at 38% 76%, #{rgba(b(anemone), 0.22)}, transparent 58%),
  radial-gradient(ellipse 3% 22% at 38% 88%, #{rgba(b(anemone), 0.14)}, transparent 70%),
  radial-gradient(ellipse 2% 18% at 35% 92%, #{rgba(b(anemone), 0.10)}, transparent 65%),
  radial-gradient(ellipse 2% 15% at 41% 94%, #{rgba(b(anemone), 0.08)}, transparent 60%),
  /* Phosphorescent plankton clouds */
  radial-gradient(circle 80px at 52% 85%, #{rgba(b(phosphor), 0.12)}, transparent 70%),
  radial-gradient(circle 50px at 48% 80%, #{rgba(b(phosphor), 0.08)}, transparent 65%),
  radial-gradient(circle 30px at 55% 78%, #{rgba(b(phosphor), 0.06)}, transparent 60%),
  /* More jellyfish */
  radial-gradient(ellipse 15% 18% at 65% 80%, #{rgba(b(jellyfish), 0.28)}, transparent 55%),
  radial-gradient(ellipse 5% 25% at 65% 92%, #{rgba(b(jellyfish), 0.18)}, transparent 70%),
  radial-gradient(ellipse 3% 20% at 62% 96%, #{rgba(b(jellyfish), 0.12)}, transparent 65%),
  radial-gradient(ellipse 3% 18% at 68% 98%, #{rgba(b(jellyfish), 0.10)}, transparent 60%),
  radial-gradient(ellipse 9% 12% at 78% 74%, #{rgba(b(anglerfish), 0.25)}, transparent 58%),
  radial-gradient(ellipse 3% 18% at 78% 85%, #{rgba(b(anglerfish), 0.15)}, transparent 70%),
  radial-gradient(ellipse 2% 14% at 75% 88%, #{rgba(b(anglerfish), 0.10)}, transparent 65%),
  radial-gradient(ellipse 2% 12% at 81% 90%, #{rgba(b(anglerfish), 0.08)}, transparent 60%),
  radial-gradient(ellipse 11% 14% at 92% 78%, #{rgba(b(anemone), 0.24)}, transparent 55%),
  radial-gradient(ellipse 4% 20% at 92% 90%, #{rgba(b(anemone), 0.16)}, transparent 70%),
  radial-gradient(ellipse 3% 16% at 89% 94%, #{rgba(b(anemone), 0.10)}, transparent 65%),
  radial-gradient(ellipse 3% 14% at 95% 96%, #{rgba(b(anemone), 0.08)}, transparent 60%),
  /* Deep sea floor glow */
  radial-gradient(ellipse 100% 12% at 50% 98%, #{rgba(b(anglerfish), 0.15)}, transparent 80%),
  radial-gradient(ellipse 60% 8% at 30% 95%, #{rgba(b(jellyfish), 0.10)}, transparent 70%),
  radial-gradient(ellipse 50% 6% at 70% 100%, #{rgba(b(anemone), 0.08)}, transparent 60%),
  linear-gradient(180deg, #{o(midnight)} 0%, #{o(abyss)} 35%, #{rgba(o(trench),0.95)} 65%, #{o(trench)} 100%);

  --sunlit-shallow: #{rgba(s(shallow),0.2)};
  --sunlit-sand: #{rgba(s(sand),0.15)};
  --sunlit-coral: #ff6b6b;
  --sunlit-seagrass: #{b(anglerfish)};
  --sunlit-starfish: #{b(phosphor)};
  --bs-body-bg-rgb: 0, 8, 20;
  --bs-body-color-rgb: 233, 236, 239;
  --bs-secondary-color: #{rgba(n(mist),0.75)};
  --bs-secondary-bg: #{o(abyss)};
  --bs-tertiary-color: #{rgba(n(mist),0.5)};
  --bs-tertiary-bg: #{o(midnight)};
  --bs-primary: #{o(surface)};
  --bs-success: #{b(anglerfish)};
  --bs-warning: #{b(phosphor)};
  --bs-danger: #ff6b6b;
  --bs-secondary: #{n(kelp)};
  --nav-link-active-text-shadow: 0 0 8px #{rgba(b(anglerfish),0.4)};
  --card-hover-shadow: 0 8px 30px rgba(0, 8, 20, 0.4), 0 0 20px rgba(b(anglerfish), 0.05);

  @include theme-vars(dark);
}

// ============================================================
// 7. Component Styles
// ============================================================

.card {
  background-color: var(--card-bg);
  border-color: var(--card-border-color);
  box-shadow: var(--card-shadow);
  transition: box-shadow $tr;

  &:hover {
    box-shadow: var(--card-hover-shadow);
  }

  .card-header {
    background-color: var(--card-header-bg);
    border-bottom-color: var(--card-border-color);
  }
}

.glass {
  background: var(--glass-bg);
  backdrop-filter: blur($blur-sm);
  -webkit-backdrop-filter: blur($blur-sm);
  border: 1px solid var(--glass-border);
  box-shadow: var(--glass-shadow);
}

.btn {
  transition: all $tr-wave;

  &:focus-visible {
    outline: 2px solid var(--btn-focus-outline);
    outline-offset: var(--focus-ring-offset);
    box-shadow: 0 0 0 4px var(--bs-focus-ring-color);
  }

  &:disabled,
  &.disabled {
    background-color: var(--disabled-bg);
    border-color: var(--disabled-border);
    color: var(--disabled-color);
    opacity: var(--disabled-opacity);
    pointer-events: none;
  }
}

.btn-primary:hover {
  background-color: var(--btn-primary-hover-bg);
  border-color: var(--btn-primary-hover-border);
}

.btn-secondary {
  --bs-btn-bg: var(--btn-secondary-bg);
  --bs-btn-border-color: var(--btn-secondary-border);
  --bs-btn-color: var(--btn-secondary-color);
  --bs-btn-hover-bg: var(--btn-secondary-hover-bg);
  --bs-btn-hover-border-color: var(--btn-secondary-hover-bg);
  --bs-btn-hover-color: #fff;
}

.form-control,
.form-select {
  background-color: var(--input-bg);
  border-color: var(--input-border);
  color: var(--bs-body-color);
  transition: border-color $tr, box-shadow $tr, background-color $tr;

  &:focus {
    border-color: var(--input-focus-border);
    box-shadow: var(--input-focus-shadow);
  }

  &::placeholder {
    color: var(--input-placeholder-color);
  }

  &:disabled,
  &[readonly] {
    background-color: var(--disabled-bg);
    border-color: var(--disabled-border);
    color: var(--disabled-color);
    opacity: var(--disabled-opacity);
  }

  &.is-invalid,
  &:invalid:not(:placeholder-shown) {
    background-color: var(--input-error-bg);
    border-color: var(--bs-form-invalid-border-color);

    &:focus {
      box-shadow: 0 0 0 0.25rem rgba(var(--bs-danger-rgb, 230, 57, 70), 0.2);
    }
  }
}

.form-label {
  color: var(--bs-body-color);
  font-weight: 500;
}

// Input group addon buttons (datepicker, etc.)
.input-group {

  .btn-outline-secondary,
  .btn-outline-primary,
  .input-group-text {
    background-color: var(--input-bg);
    border-color: var(--input-border);
    color: var(--bs-body-color);

    &:hover {
      background-color: var(--table-hover-bg);
      border-color: var(--input-focus-border);
      color: var(--bs-emphasis-color);
    }

    &:focus {
      border-color: var(--input-focus-border);
      box-shadow: var(--input-focus-shadow);
    }
  }

  // Ensure the calendar/datepicker button is visible
  [ngbdatepickertoggle] .btn,
  .ngb-dp-button,
  button[type="button"]:has(i.bi-calendar),
  .btn:has(.bi-calendar),
  .btn:has(.bi-calendar3) {
    background-color: var(--btn-secondary-bg);
    border-color: var(--input-border);
    color: var(--btn-secondary-color);

    &:hover {
      background-color: var(--btn-secondary-hover-bg);
      border-color: var(--input-focus-border);
    }
  }
}

// Standalone datepicker toggle button styling
[data-bs-theme="dark"] {
  .btn-outline-secondary {
    --bs-btn-color: #{n(mist)};
    --bs-btn-border-color: rgba(#{o(surface)}, 0.3);
    --bs-btn-hover-color: #fff;
    --bs-btn-hover-bg: #{n(current)};
    --bs-btn-hover-border-color: #{o(surface)};
    --bs-btn-active-color: #fff;
    --bs-btn-active-bg: #{n(kelp)};
  }
}

.table {
  --bs-table-bg: var(--table-bg);
  --bs-table-striped-bg: var(--table-striped-bg);
  --bs-table-hover-bg: var(--table-hover-bg);
  --bs-table-border-color: var(--table-border-color);
  background-color: var(--table-bg);

  thead th {
    background-color: var(--table-header-bg);
    color: var(--table-header-color);
    font-weight: 600;
    border-bottom-width: 2px;
  }

  tbody td {
    background-color: var(--table-bg);
    color: var(--table-cell-color);
  }

  td {
    color: var(--table-cell-color);
  }
}

.table>tbody>tr.table-primary,
.table>tbody>tr.table-active,
.table>tbody>tr[aria-selected="true"] {
  --bs-table-bg: var(--table-active-bg);
  --bs-table-color: var(--table-active-color);
  --bs-table-striped-bg: var(--table-active-bg);
  --bs-table-accent-bg: var(--table-active-bg);
  --bs-table-hover-bg: var(--table-active-bg);
  background-color: var(--table-active-bg) !important;
  border-left: 3px solid var(--table-active-border);

  >td,
  >th {
    color: var(--table-active-color) !important;
    background-color: var(--table-active-bg) !important;
  }

  &:hover>td,
  &:hover>th {
    background-color: var(--table-active-bg) !important;
    color: var(--table-active-color) !important;
  }

  .table-row-actions {
    opacity: 1;
    color: var(--table-action-hover-color);
  }
}

.table-row-actions {
  opacity: 0.85;
  color: var(--table-action-color);
  transition: opacity $tr, color $tr;

  &:hover,
  &:focus-within {
    opacity: 1;
    color: var(--table-action-hover-color);
  }
}

.alert {
  border-left-width: 4px;
  border-radius: var(--bs-border-radius);
}

@each $type, $_ in $alerts {
  .alert-#{$type} {
    background-color: var(--alert-#{$type}-bg);
    border-color: var(--alert-#{$type}-border);
    border-left-color: var(--alert-#{$type}-accent);
    color: var(--alert-#{$type}-color);
    text-shadow: var(--alert-#{$type}-text-shadow, none);

    .alert-link {
      color: var(--alert-#{$type}-color);
      filter: brightness(0.9);
    }
  }
}

@each $type, $_ in $badges {
  .badge.bg-#{$type} {
    background-color: var(--badge-#{$type}-bg) !important;
    color: var(--badge-#{$type}-color) !important;
  }
}

.nav-link {
  transition: all $tr-wave;
  position: relative;

  &.active {
    color: var(--nav-link-active-color) !important;
    text-shadow: var(--nav-link-active-text-shadow, none);
  }
}

// Fix #7: Visited link styles
a:visited:not(.btn):not(.nav-link):not(.dropdown-item) {
  color: var(--link-visited-color);
}

// Fix #4: Global focus enhancement for interactive elements
:focus-visible {
  outline: 2px solid var(--btn-focus-outline);
  outline-offset: var(--focus-ring-offset, 2px);
}

// Fix #3: Disabled table rows
.table>tbody>tr.disabled,
.table>tbody>tr[aria-disabled="true"] {
  opacity: var(--disabled-opacity);
  pointer-events: none;

  >td {
    color: var(--disabled-color);
  }
}

.dropdown-menu {
  --bs-dropdown-bg: var(--dropdown-bg);
  backdrop-filter: blur($blur-md);
  box-shadow: var(--bs-box-shadow-lg);
  border-color: var(--dropdown-border);
}

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--scrollbar-track);
}

::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb);
  border-radius: 4px;
}

::selection {
  background: var(--selection-bg);
  color: var(--bs-emphasis-color);
}

// ============================================================
// 8. Utilities
// ============================================================

@each $k, $v in $ocean {
  .bg-ocean-#{$k} {
    background-color: $v !important;
  }

  .text-ocean-#{$k} {
    color: $v !important;
  }

  .border-ocean-#{$k} {
    border-color: $v !important;
  }
}

@each $k in (sky, foam, shallow, lagoon, sand) {
  .bg-sunlit-#{$k} {
    background-color: s($k) !important;
  }
}

@each $k, $v in $bio {
  .glow-#{$k} {
    box-shadow: 0 0 20px rgba($v, 0.15), 0 0 40px rgba($v, 0.075), 0 0 60px rgba($v, 0.03);
  }
}

@each $k, $v in $shadow-l {
  .shadow-sunlit-#{$k} {
    box-shadow: $v !important;
  }
}

.animate-pulse {
  animation: bio-pulse 2s ease-in-out infinite;
}

.animate-float {
  animation: jellyfish-float 3s ease-in-out infinite;
}

.animate-drift {
  animation: depth-drift 4s ease-in-out infinite;
}

.text-gradient-ocean {
  background: var(--nav-link-underline);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.text-gradient-bio {
  background: linear-gradient(135deg, var(--bio-anglerfish) 0%, var(--bio-jellyfish) 50%, #{b(anemone)} 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

// ============================================================
// 9. Accessibility
// ============================================================

@media (prefers-contrast: more) {
  .glass {
    background: rgba(255, 255, 255, 0.4);
  }

  .table-row-actions {
    opacity: 1 !important;
  }
}

@media (prefers-reduced-motion: reduce) {

  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}