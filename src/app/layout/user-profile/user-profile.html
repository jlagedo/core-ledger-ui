<div
  [class.justify-content-center]="isCollapsed()"
  [class.justify-content-between]="!isCollapsed()"
  class="d-flex align-items-center p-3"
>
  <!-- User Avatar with Dropdown -->
  <div ngbDropdown container="body" placement="top-start">
    <button
      ngbDropdownToggle
      [attr.aria-label]="'User profile'"
      class="btn btn-link text-white p-0 border-0"
    >
      @if (userProfile()?.picture) {
        <img
          [src]="userProfile()!.picture"
          [alt]="userProfile()!.name"
          class="rounded-circle"
          width="32"
          height="32"
          referrerpolicy="no-referrer"
        />
      } @else {
        <i class="bi bi-person-circle" style="font-size: 1.5rem"></i>
      }
    </button>

    <div ngbDropdownMenu class="shadow-sm">
      @if (userProfile()) {
        <div class="px-3 py-2 border-bottom">
          <div class="fw-semibold">{{ userProfile()!.name }}</div>
          <small class="text-body-secondary">{{ userProfile()!.email }}</small>
        </div>
      }
      <button ngbDropdownItem routerLink="/profile">
        <i class="bi bi-person me-2"></i>View Profile
      </button>
      <button ngbDropdownItem (click)="logout()">
        <i class="bi bi-box-arrow-right me-2"></i>Logout
      </button>
    </div>
  </div>

  <!-- Theme Toggle (hidden when collapsed) -->
  @if (!isCollapsed()) {
    <button
      (click)="toggleTheme()"
      [attr.aria-label]="isDarkMode() ? 'Switch to light mode' : 'Switch to dark mode'"
      class="btn btn-link text-white p-0"
      type="button"
    >
      <i
        [class]="isDarkMode() ? 'bi bi-sun-fill' : 'bi bi-moon-fill'"
        style="font-size: 1.25rem"
      ></i>
    </button>
  }
</div>
