<div class="d-flex flex-column flex-shrink-0 p-3 text-bg-dark transition-all border-end border-tertiary" 
     [style.width]="isSidenavCollapsed() ? '70px' : '280px'" 
     style="height: 100vh;" 
     [attr.aria-label]="isSidenavCollapsed() ? 'Collapsed sidenav' : 'Expanded sidenav'">
    
    <!-- Logo & Toggle Section -->
    <div class="d-flex align-items-center mb-3"
         [ngClass]="{'justify-content-between': !isSidenavCollapsed(), 'justify-content-center': isSidenavCollapsed()}">
        <a class="d-flex align-items-center text-white text-decoration-none" 
           [routerLink]="isSidenavCollapsed() ? null : '/dashboard'"
           (click)="handleLogoClick($event)"
           [ngClass]="{'cursor-pointer': isSidenavCollapsed()}"
           [attr.role]="isSidenavCollapsed() ? 'button' : null"
           [attr.aria-label]="isSidenavCollapsed() ? 'Expand sidenav' : 'Go to dashboard'"
           tabindex="0">
            <img src="apple-touch-icon.png" alt="Fluxo Logo" width="32" height="32" [ngClass]="{'me-2': !isSidenavCollapsed()}">
            @if (!isSidenavCollapsed()) {
                <span class="fs-4">Fluxo</span>
            }
        </a>
        @if (!isSidenavCollapsed()) {
            <button class="btn btn-link text-white p-0 border-0" 
                    (click)="toggleSidenav()" 
                    [attr.aria-label]="'Collapse sidenav'"
                    [attr.aria-expanded]="true">
                <i class="bi bi-x-lg" style="font-size: 1.5rem;"></i>
            </button>
        }
    </div>
    <hr>
    <!-- Navigation Menu -->
    <ul class="nav nav-pills flex-column mb-auto">
        <!-- Overview -->
        <li class="nav-item">
            <a class="nav-link text-white d-flex align-items-center" 
               [ngClass]="{'justify-content-center': isSidenavCollapsed()}"
               routerLink="/dashboard" routerLinkActive="active"
               [routerLinkActiveOptions]="{ exact: true }" aria-current="page"
               [ngbTooltip]="isSidenavCollapsed() ? 'Overview' : ''"
               placement="end">
                <i class="bi bi-grid-fill" [ngClass]="{'me-2': !isSidenavCollapsed()}"></i>
                @if (!isSidenavCollapsed()) {
                    <span>Overview</span>
                }
            </a>
        </li>
        
        <!-- Ledger with Submenu -->
        <li>
            <a class="nav-link text-white d-flex align-items-center" 
               [ngClass]="{'justify-content-center': isSidenavCollapsed()}"
               (click)="toggleLedger()" role="button" 
               [attr.aria-expanded]="!isLedgerCollapsed()" 
               aria-controls="ledgerSubmenu"
               [ngbTooltip]="isSidenavCollapsed() ? 'Ledger' : ''"
               placement="end">
                <i class="bi bi-book" [ngClass]="{'me-2': !isSidenavCollapsed()}"></i>
                @if (!isSidenavCollapsed()) {
                    <span>Ledger</span>
                }
            </a>
            <div [ngbCollapse]="isLedgerCollapsed()" id="ledgerSubmenu">
                <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small" 
                    [ngClass]="{'ms-3': !isSidenavCollapsed()}">
                    <li>
                        <a class="nav-link text-white d-flex align-items-center" 
                           routerLink="/chart-of-accounts" routerLinkActive="active" 
                           [routerLinkActiveOptions]="{ exact: true }"
                           [ngbTooltip]="isSidenavCollapsed() ? 'Chart of Accounts' : ''"
                           placement="end">
                           @if (isSidenavCollapsed()) {
                               <span class="submenu-indicator"></span>
                           } @else {
                               <span>Chart of Accounts</span>
                           }
                        </a>
                    </li>
                    <li>
                        <a class="nav-link text-white d-flex align-items-center" 
                           routerLink="/chart-of-accounts/new" routerLinkActive="active"
                           [ngbTooltip]="isSidenavCollapsed() ? 'New Account' : ''"
                           placement="end">
                           @if (isSidenavCollapsed()) {
                               <span class="submenu-indicator"></span>
                           } @else {
                               <span>New Account</span>
                           }
                        </a>
                    </li>
                </ul>
            </div>
        </li>
        
        <!-- Journal -->
        <li>
            <a class="nav-link text-white d-flex align-items-center" 
               [ngClass]="{'justify-content-center': isSidenavCollapsed()}"
               routerLink="/journal-entries" routerLinkActive="active"
               [ngbTooltip]="isSidenavCollapsed() ? 'Journal' : ''"
               placement="end">
                <i class="bi bi-journal-text" [ngClass]="{'me-2': !isSidenavCollapsed()}"></i>
                @if (!isSidenavCollapsed()) {
                    <span>Journal</span>
                }
            </a>
        </li>
        
        <!-- Periods -->
        <li>
            <a class="nav-link text-white d-flex align-items-center" 
               [ngClass]="{'justify-content-center': isSidenavCollapsed()}"
               routerLink="/posting-periods" routerLinkActive="active"
               [ngbTooltip]="isSidenavCollapsed() ? 'Periods' : ''"
               placement="end">
                <i class="bi bi-calendar3" [ngClass]="{'me-2': !isSidenavCollapsed()}"></i>
                @if (!isSidenavCollapsed()) {
                    <span>Periods</span>
                }
            </a>
        </li>
        
        <!-- Reports -->
        <li>
            <a class="nav-link text-white d-flex align-items-center" 
               [ngClass]="{'justify-content-center': isSidenavCollapsed()}"
               routerLink="/balances-reports" routerLinkActive="active"
               [ngbTooltip]="isSidenavCollapsed() ? 'Reports' : ''"
               placement="end">
                <i class="bi bi-graph-up" [ngClass]="{'me-2': !isSidenavCollapsed()}"></i>
                @if (!isSidenavCollapsed()) {
                    <span>Reports</span>
                }
            </a>
        </li>
        
        <!-- Settings -->
        <li>
            <a class="nav-link text-white d-flex align-items-center" 
               [ngClass]="{'justify-content-center': isSidenavCollapsed()}"
               routerLink="/administration" routerLinkActive="active"
               [ngbTooltip]="isSidenavCollapsed() ? 'Settings' : ''"
               placement="end">
                <i class="bi bi-gear" [ngClass]="{'me-2': !isSidenavCollapsed()}"></i>
                @if (!isSidenavCollapsed()) {
                    <span>Settings</span>
                }
            </a>
        </li>
    </ul>
</div>
